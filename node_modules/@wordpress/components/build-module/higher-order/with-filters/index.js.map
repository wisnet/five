{"version":3,"sources":["/Users/riad/Workspace/a8c/gutenberg/packages/components/src/higher-order/with-filters/index.js"],"names":["debounce","uniqueId","Component","addAction","applyFilters","removeAction","createHigherOrderComponent","ANIMATION_FRAME_PERIOD","withFilters","hookName","OriginalComponent","props","onHooksUpdated","bind","namespace","throttledForceUpdate","forceUpdate","cancel","updatedHookName"],"mappings":";;;;;;;;AAAA;;;AAGA,SAASA,QAAT,EAAmBC,QAAnB,QAAmC,QAAnC;AAEA;;;;AAGA,SAASC,SAAT,QAA0B,oBAA1B;AACA,SAASC,SAAT,EAAoBC,YAApB,EAAkCC,YAAlC,QAAsD,kBAAtD;AACA,SAASC,0BAAT,QAA2C,oBAA3C;AAEA,IAAMC,sBAAsB,GAAG,EAA/B;AAEA;;;;;;;;;;;AAUA,eAAe,SAASC,WAAT,CAAsBC,QAAtB,EAAiC;AAC/C,SAAOH,0BAA0B,CAAE,UAAEI,iBAAF,EAAyB;AAC3D;AAAA;AAAA;AAAA;;AACC;AACA,mCAAaC,KAAb,EAAqB;AAAA;;AAAA;;AACpB,iGAAOA,KAAP;AAEA,gBAAKC,cAAL,GAAsB,MAAKA,cAAL,CAAoBC,IAApB,uDAAtB;AACA,gBAAKX,SAAL,GAAiBE,YAAY,CAAEK,QAAF,EAAYC,iBAAZ,CAA7B;AACA,gBAAKI,SAAL,GAAiBb,QAAQ,CAAE,8BAAF,CAAzB;AACA,gBAAKc,oBAAL,GAA4Bf,QAAQ,CAAE,YAAM;AAC3C,kBAAKE,SAAL,GAAiBE,YAAY,CAAEK,QAAF,EAAYC,iBAAZ,CAA7B;;AACA,kBAAKM,WAAL;AACA,WAHmC,EAGjCT,sBAHiC,CAApC;AAKAJ,UAAAA,SAAS,CAAE,aAAF,EAAiB,MAAKW,SAAtB,EAAiC,MAAKF,cAAtC,CAAT;AACAT,UAAAA,SAAS,CAAE,WAAF,EAAe,MAAKW,SAApB,EAA+B,MAAKF,cAApC,CAAT;AAZoB;AAapB;AAED;;;AAjBD;AAAA;AAAA,iDAkBwB;AACtB,iBAAKG,oBAAL,CAA0BE,MAA1B;AACAZ,YAAAA,YAAY,CAAE,aAAF,EAAiB,KAAKS,SAAtB,CAAZ;AACAT,YAAAA,YAAY,CAAE,WAAF,EAAe,KAAKS,SAApB,CAAZ;AACA;AAED;;;;;;AAxBD;AAAA;AAAA,yCA6BiBI,eA7BjB,EA6BmC;AACjC,gBAAKA,eAAe,KAAKT,QAAzB,EAAoC;AACnC,mBAAKM,oBAAL;AACA;AACD;AAED;;AAnCD;AAAA;AAAA,mCAoCU;AACR,mBAAO,mBAAM,SAAN,EAAqB,KAAKJ,KAA1B,CAAP;AACA;AAtCF;;AAAA;AAAA,QAAuCT,SAAvC;AAAA;AAwCA,GAzCgC,EAyC9B,aAzC8B,CAAjC;AA0CA","sourcesContent":["/**\n * External dependencies\n */\nimport { debounce, uniqueId } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { addAction, applyFilters, removeAction } from '@wordpress/hooks';\nimport { createHigherOrderComponent } from '@wordpress/compose';\n\nconst ANIMATION_FRAME_PERIOD = 16;\n\n/**\n * Creates a higher-order component which adds filtering capability to the\n * wrapped component. Filters get applied when the original component is about\n * to be mounted. When a filter is added or removed that matches the hook name,\n * the wrapped component re-renders.\n *\n * @param {string} hookName Hook name exposed to be used by filters.\n *\n * @return {Function} Higher-order component factory.\n */\nexport default function withFilters( hookName ) {\n\treturn createHigherOrderComponent( ( OriginalComponent ) => {\n\t\treturn class FilteredComponent extends Component {\n\t\t\t/** @inheritdoc */\n\t\t\tconstructor( props ) {\n\t\t\t\tsuper( props );\n\n\t\t\t\tthis.onHooksUpdated = this.onHooksUpdated.bind( this );\n\t\t\t\tthis.Component = applyFilters( hookName, OriginalComponent );\n\t\t\t\tthis.namespace = uniqueId( 'core/with-filters/component-' );\n\t\t\t\tthis.throttledForceUpdate = debounce( () => {\n\t\t\t\t\tthis.Component = applyFilters( hookName, OriginalComponent );\n\t\t\t\t\tthis.forceUpdate();\n\t\t\t\t}, ANIMATION_FRAME_PERIOD );\n\n\t\t\t\taddAction( 'hookRemoved', this.namespace, this.onHooksUpdated );\n\t\t\t\taddAction( 'hookAdded', this.namespace, this.onHooksUpdated );\n\t\t\t}\n\n\t\t\t/** @inheritdoc */\n\t\t\tcomponentWillUnmount() {\n\t\t\t\tthis.throttledForceUpdate.cancel();\n\t\t\t\tremoveAction( 'hookRemoved', this.namespace );\n\t\t\t\tremoveAction( 'hookAdded', this.namespace );\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * When a filter is added or removed for the matching hook name, the wrapped component should re-render.\n\t\t\t *\n\t\t\t * @param {string} updatedHookName  Name of the hook that was updated.\n\t\t\t */\n\t\t\tonHooksUpdated( updatedHookName ) {\n\t\t\t\tif ( updatedHookName === hookName ) {\n\t\t\t\t\tthis.throttledForceUpdate();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/** @inheritdoc */\n\t\t\trender() {\n\t\t\t\treturn <this.Component { ...this.props } />;\n\t\t\t}\n\t\t};\n\t}, 'withFilters' );\n}\n"]}