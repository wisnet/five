{"version":3,"sources":["/Users/riad/Workspace/a8c/gutenberg/packages/components/src/higher-order/with-constrained-tabbing/index.js"],"names":["Component","createRef","createHigherOrderComponent","TAB","focus","withConstrainedTabbing","WrappedComponent","arguments","focusContainRef","handleTabBehaviour","bind","event","keyCode","tabbables","tabbable","find","current","length","firstTabbable","lastTabbable","shiftKey","target","preventDefault","includes","props"],"mappings":";;;;;;;;AAAA;;;AAGA,SAASA,SAAT,EAAoBC,SAApB,QAAqC,oBAArC;AACA,SAASC,0BAAT,QAA2C,oBAA3C;AACA,SAASC,GAAT,QAAoB,qBAApB;AACA,SAASC,KAAT,QAAsB,gBAAtB;AAEA,IAAMC,sBAAsB,GAAGH,0BAA0B,CACxD,UAAEI,gBAAF;AAAA;AAAA;AAAA;AAAA;;AACC,wBAAc;AAAA;;AAAA;;AACb,qFAAUC,SAAV;AAEA,cAAKC,eAAL,GAAuBP,SAAS,EAAhC;AACA,cAAKQ,kBAAL,GAA0B,MAAKA,kBAAL,CAAwBC,IAAxB,uDAA1B;AAJa;AAKb;;AANF;AAAA;AAAA,2CAQqBC,KARrB,EAQ6B;AAC3B,cAAKA,KAAK,CAACC,OAAN,KAAkBT,GAAvB,EAA6B;AAC5B;AACA;;AAED,cAAMU,SAAS,GAAGT,KAAK,CAACU,QAAN,CAAeC,IAAf,CAAqB,KAAKP,eAAL,CAAqBQ,OAA1C,CAAlB;;AACA,cAAK,CAAEH,SAAS,CAACI,MAAjB,EAA0B;AACzB;AACA;;AACD,cAAMC,aAAa,GAAGL,SAAS,CAAE,CAAF,CAA/B;AACA,cAAMM,YAAY,GAAGN,SAAS,CAAEA,SAAS,CAACI,MAAV,GAAmB,CAArB,CAA9B;;AAEA,cAAKN,KAAK,CAACS,QAAN,IAAkBT,KAAK,CAACU,MAAN,KAAiBH,aAAxC,EAAwD;AACvDP,YAAAA,KAAK,CAACW,cAAN;AACAH,YAAAA,YAAY,CAACf,KAAb;AACA,WAHD,MAGO,IAAK,CAAEO,KAAK,CAACS,QAAR,IAAoBT,KAAK,CAACU,MAAN,KAAiBF,YAA1C,EAAyD;AAC/DR,YAAAA,KAAK,CAACW,cAAN;AACAJ,YAAAA,aAAa,CAACd,KAAd;AACD;;;;AAIC,WAPM,MAOA,IAAK,CAAES,SAAS,CAACU,QAAV,CAAoBZ,KAAK,CAACU,MAA1B,CAAP,EAA4C;AAClDV,YAAAA,KAAK,CAACW,cAAN;AACAJ,YAAAA,aAAa,CAACd,KAAd;AACA;AACD;AAlCF;AAAA;AAAA,iCAoCU;AACR;AACA;;AACA;AACA,iBACC;AACC,YAAA,SAAS,EAAG,KAAKK,kBADlB;AAEC,YAAA,GAAG,EAAG,KAAKD,eAFZ;AAGC,YAAA,QAAQ,EAAC;AAHV,aAKC,cAAC,gBAAD,EAAuB,KAAKgB,KAA5B,CALD,CADD;AASA;AACA;AAlDF;;AAAA;AAAA,MAAsCxB,SAAtC;AAAA;AAAA,CADwD,EAqDxD,wBArDwD,CAAzD;AAwDA,eAAeK,sBAAf","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { Component, createRef } from '@wordpress/element';\nimport { createHigherOrderComponent } from '@wordpress/compose';\nimport { TAB } from '@wordpress/keycodes';\nimport { focus } from '@wordpress/dom';\n\nconst withConstrainedTabbing = createHigherOrderComponent(\n\t( WrappedComponent ) => class extends Component {\n\t\tconstructor() {\n\t\t\tsuper( ...arguments );\n\n\t\t\tthis.focusContainRef = createRef();\n\t\t\tthis.handleTabBehaviour = this.handleTabBehaviour.bind( this );\n\t\t}\n\n\t\thandleTabBehaviour( event ) {\n\t\t\tif ( event.keyCode !== TAB ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst tabbables = focus.tabbable.find( this.focusContainRef.current );\n\t\t\tif ( ! tabbables.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst firstTabbable = tabbables[ 0 ];\n\t\t\tconst lastTabbable = tabbables[ tabbables.length - 1 ];\n\n\t\t\tif ( event.shiftKey && event.target === firstTabbable ) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tlastTabbable.focus();\n\t\t\t} else if ( ! event.shiftKey && event.target === lastTabbable ) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tfirstTabbable.focus();\n\t\t\t/*\n\t\t\t * When pressing Tab and none of the tabbables has focus, the keydown\n\t\t\t * event happens on the wrapper div: move focus on the first tabbable.\n\t\t\t */\n\t\t\t} else if ( ! tabbables.includes( event.target ) ) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tfirstTabbable.focus();\n\t\t\t}\n\t\t}\n\n\t\trender() {\n\t\t\t// Disable reason: this component is non-interactive, but must capture\n\t\t\t// events from the wrapped component to determine when the Tab key is used.\n\t\t\t/* eslint-disable jsx-a11y/no-static-element-interactions */\n\t\t\treturn (\n\t\t\t\t<div\n\t\t\t\t\tonKeyDown={ this.handleTabBehaviour }\n\t\t\t\t\tref={ this.focusContainRef }\n\t\t\t\t\ttabIndex=\"-1\"\n\t\t\t\t>\n\t\t\t\t\t<WrappedComponent { ...this.props } />\n\t\t\t\t</div>\n\t\t\t);\n\t\t\t/* eslint-enable jsx-a11y/no-static-element-interactions */\n\t\t}\n\t},\n\t'withConstrainedTabbing'\n);\n\nexport default withConstrainedTabbing;\n"]}