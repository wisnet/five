{"version":3,"sources":["/Users/riad/Workspace/a8c/gutenberg/packages/components/src/slot-fill/fill.js"],"names":["isFunction","Component","createPortal","Consumer","occurrences","FillComponent","arguments","occurrence","registerFill","props","name","getSlot","slot","bubblesVirtually","forceUpdate","unregisterFill","prevProps","children","fillProps","node","Fill"],"mappings":";;;;;;;;AAAA;;;AAGA,SAASA,UAAT,QAA2B,QAA3B;AAEA;;;;AAGA,SAASC,SAAT,EAAoBC,YAApB,QAAwC,oBAAxC;AAEA;;;;AAGA,SAASC,QAAT,QAAyB,WAAzB;AAEA,IAAIC,WAAW,GAAG,CAAlB;;IAEMC,a;;;;;AACL,2BAAc;AAAA;;AAAA;;AACb,wFAAUC,SAAV;AACA,UAAKC,UAAL,GAAkB,EAAEH,WAApB;AAFa;AAGb;;;;wCAEmB;AAAA,UACXI,YADW,GACM,KAAKC,KADX,CACXD,YADW;AAGnBA,MAAAA,YAAY,CAAE,KAAKC,KAAL,CAAWC,IAAb,EAAmB,IAAnB,CAAZ;AACA;;;0CAEqB;AACrB,UAAK,CAAE,KAAKH,UAAZ,EAAyB;AACxB,aAAKA,UAAL,GAAkB,EAAEH,WAApB;AACA;;AAHoB,UAIbO,OAJa,GAID,KAAKF,KAJJ,CAIbE,OAJa;AAKrB,UAAMC,IAAI,GAAGD,OAAO,CAAE,KAAKF,KAAL,CAAWC,IAAb,CAApB;;AACA,UAAKE,IAAI,IAAI,CAAEA,IAAI,CAACH,KAAL,CAAWI,gBAA1B,EAA6C;AAC5CD,QAAAA,IAAI,CAACE,WAAL;AACA;AACD;;;2CAEsB;AAAA,UACdC,cADc,GACK,KAAKN,KADV,CACdM,cADc;AAGtBA,MAAAA,cAAc,CAAE,KAAKN,KAAL,CAAWC,IAAb,EAAmB,IAAnB,CAAd;AACA;;;uCAEmBM,S,EAAY;AAAA,wBACgB,KAAKP,KADrB;AAAA,UACvBC,IADuB,eACvBA,IADuB;AAAA,UACjBK,cADiB,eACjBA,cADiB;AAAA,UACDP,YADC,eACDA,YADC;;AAG/B,UAAKQ,SAAS,CAACN,IAAV,KAAmBA,IAAxB,EAA+B;AAC9BK,QAAAA,cAAc,CAAEC,SAAS,CAACN,IAAZ,EAAkB,IAAlB,CAAd;AACAF,QAAAA,YAAY,CAAEE,IAAF,EAAQ,IAAR,CAAZ;AACA;AACD;;;sCAEiB;AACjB,WAAKH,UAAL,GAAkB,IAAlB;AACA;;;6BAEQ;AAAA,yBACkB,KAAKE,KADvB;AAAA,UACAC,IADA,gBACAA,IADA;AAAA,UACMC,OADN,gBACMA,OADN;AAAA,UAEFM,QAFE,GAEW,KAAKR,KAFhB,CAEFQ,QAFE;AAGR,UAAML,IAAI,GAAGD,OAAO,CAAED,IAAF,CAApB;;AAEA,UAAK,CAAEE,IAAF,IAAU,CAAEA,IAAI,CAACH,KAAL,CAAWI,gBAA5B,EAA+C;AAC9C,eAAO,IAAP;AACA,OAPO,CASR;;;AACA,UAAKb,UAAU,CAAEiB,QAAF,CAAf,EAA8B;AAC7BA,QAAAA,QAAQ,GAAGA,QAAQ,CAAEL,IAAI,CAACH,KAAL,CAAWS,SAAb,CAAnB;AACA;;AAED,aAAOhB,YAAY,CAAEe,QAAF,EAAYL,IAAI,CAACO,IAAjB,CAAnB;AACA;;;;EAzD0BlB,S;;AA4D5B,IAAMmB,IAAI,GAAG,SAAPA,IAAO,CAAEX,KAAF;AAAA,SACZ,cAAC,QAAD,QACG;AAAA,QAAIE,OAAJ,QAAIA,OAAJ;AAAA,QAAaH,YAAb,QAAaA,YAAb;AAAA,QAA2BO,cAA3B,QAA2BA,cAA3B;AAAA,WACD,cAAC,aAAD,eACMN,KADN;AAEC,MAAA,OAAO,EAAGE,OAFX;AAGC,MAAA,YAAY,EAAGH,YAHhB;AAIC,MAAA,cAAc,EAAGO;AAJlB,OADC;AAAA,GADH,CADY;AAAA,CAAb;;AAaA,eAAeK,IAAf","sourcesContent":["/**\n * External dependencies\n */\nimport { isFunction } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { Component, createPortal } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport { Consumer } from './context';\n\nlet occurrences = 0;\n\nclass FillComponent extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.occurrence = ++occurrences;\n\t}\n\n\tcomponentDidMount() {\n\t\tconst { registerFill } = this.props;\n\n\t\tregisterFill( this.props.name, this );\n\t}\n\n\tcomponentWillUpdate() {\n\t\tif ( ! this.occurrence ) {\n\t\t\tthis.occurrence = ++occurrences;\n\t\t}\n\t\tconst { getSlot } = this.props;\n\t\tconst slot = getSlot( this.props.name );\n\t\tif ( slot && ! slot.props.bubblesVirtually ) {\n\t\t\tslot.forceUpdate();\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\tconst { unregisterFill } = this.props;\n\n\t\tunregisterFill( this.props.name, this );\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tconst { name, unregisterFill, registerFill } = this.props;\n\n\t\tif ( prevProps.name !== name ) {\n\t\t\tunregisterFill( prevProps.name, this );\n\t\t\tregisterFill( name, this );\n\t\t}\n\t}\n\n\tresetOccurrence() {\n\t\tthis.occurrence = null;\n\t}\n\n\trender() {\n\t\tconst { name, getSlot } = this.props;\n\t\tlet { children } = this.props;\n\t\tconst slot = getSlot( name );\n\n\t\tif ( ! slot || ! slot.props.bubblesVirtually ) {\n\t\t\treturn null;\n\t\t}\n\n\t\t// If a function is passed as a child, provide it with the fillProps.\n\t\tif ( isFunction( children ) ) {\n\t\t\tchildren = children( slot.props.fillProps );\n\t\t}\n\n\t\treturn createPortal( children, slot.node );\n\t}\n}\n\nconst Fill = ( props ) => (\n\t<Consumer>\n\t\t{ ( { getSlot, registerFill, unregisterFill } ) => (\n\t\t\t<FillComponent\n\t\t\t\t{ ...props }\n\t\t\t\tgetSlot={ getSlot }\n\t\t\t\tregisterFill={ registerFill }\n\t\t\t\tunregisterFill={ unregisterFill }\n\t\t\t/>\n\t\t) }\n\t</Consumer>\n);\n\nexport default Fill;\n"]}