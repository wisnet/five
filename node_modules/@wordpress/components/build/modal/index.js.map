{"version":3,"sources":["/Users/riad/Workspace/a8c/gutenberg/packages/components/src/modal/index.js"],"names":["parentElement","openModalCount","Modal","props","prepareDOM","openFirstModal","closeLastModal","cleanDOM","document","createElement","body","appendChild","node","removeChild","ariaHelper","hideApp","classList","add","bodyOpenClassName","remove","showApp","overlayClassName","className","onRequestClose","title","icon","closeButtonLabel","children","aria","instanceId","isDismissable","otherProps","headingId","labelledby","describedby","Component","defaultProps","role","noop","focusOnMount","shouldCloseOnEsc","shouldCloseOnClickOutside"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\nimport { noop } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { Component, createPortal } from '@wordpress/element';\nimport { withInstanceId } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport ModalFrame from './frame';\nimport ModalHeader from './header';\nimport * as ariaHelper from './aria-helper';\nimport IsolatedEventContainer from '../isolated-event-container';\n\n// Used to count the number of open modals.\nlet parentElement,\n\topenModalCount = 0;\n\nclass Modal extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\n\t\tthis.prepareDOM();\n\t}\n\n\t/**\n\t * Appends the modal's node to the DOM, so the portal can render the\n\t * modal in it. Also calls the openFirstModal when this is the first modal to be\n\t * opened.\n\t */\n\tcomponentDidMount() {\n\t\topenModalCount++;\n\n\t\tif ( openModalCount === 1 ) {\n\t\t\tthis.openFirstModal();\n\t\t}\n\t}\n\n\t/**\n\t * Removes the modal's node from the DOM. Also calls closeLastModal when this is\n\t * the last modal to be closed.\n\t */\n\tcomponentWillUnmount() {\n\t\topenModalCount--;\n\n\t\tif ( openModalCount === 0 ) {\n\t\t\tthis.closeLastModal();\n\t\t}\n\n\t\tthis.cleanDOM();\n\t}\n\n\t/**\n\t * Prepares the DOM for the modals to be rendered.\n\t *\n\t * Every modal is mounted in a separate div appended to a parent div\n\t * that is appended to the document body.\n\t *\n\t * The parent div will be created if it does not yet exist, and the\n\t * separate div for this specific modal will be appended to that.\n\t */\n\tprepareDOM() {\n\t\tif ( ! parentElement ) {\n\t\t\tparentElement = document.createElement( 'div' );\n\t\t\tdocument.body.appendChild( parentElement );\n\t\t}\n\t\tthis.node = document.createElement( 'div' );\n\t\tparentElement.appendChild( this.node );\n\t}\n\n\t/**\n\t * Removes the specific mounting point for this modal from the DOM.\n\t */\n\tcleanDOM() {\n\t\tparentElement.removeChild( this.node );\n\t}\n\n\t/**\n\t * Prepares the DOM for this modal and any additional modal to be mounted.\n\t *\n\t * It appends an additional div to the body for the modals to be rendered in,\n\t * it hides any other elements from screen-readers and adds an additional class\n\t * to the body to prevent scrolling while the modal is open.\n\t */\n\topenFirstModal() {\n\t\tariaHelper.hideApp( parentElement );\n\t\tdocument.body.classList.add( this.props.bodyOpenClassName );\n\t}\n\n\t/**\n\t * Cleans up the DOM after the last modal is closed and makes the app available\n\t * for screen-readers again.\n\t */\n\tcloseLastModal() {\n\t\tdocument.body.classList.remove( this.props.bodyOpenClassName );\n\t\tariaHelper.showApp();\n\t}\n\n\t/**\n\t * Renders the modal.\n\t *\n\t * @return {WPElement} The modal element.\n\t */\n\trender() {\n\t\tconst {\n\t\t\toverlayClassName,\n\t\t\tclassName,\n\t\t\tonRequestClose,\n\t\t\ttitle,\n\t\t\ticon,\n\t\t\tcloseButtonLabel,\n\t\t\tchildren,\n\t\t\taria,\n\t\t\tinstanceId,\n\t\t\tisDismissable,\n\t\t\t...otherProps\n\t\t} = this.props;\n\n\t\tconst headingId = aria.labelledby || `components-modal-header-${ instanceId }`;\n\n\t\t// Disable reason: this stops mouse events from triggering tooltips and\n\t\t// other elements underneath the modal overlay.\n\t\t/* eslint-disable jsx-a11y/no-static-element-interactions */\n\t\treturn createPortal(\n\t\t\t<IsolatedEventContainer\n\t\t\t\tclassName={ classnames( 'components-modal__screen-overlay', overlayClassName ) }\n\t\t\t>\n\t\t\t\t<ModalFrame\n\t\t\t\t\tclassName={ classnames(\n\t\t\t\t\t\t'components-modal__frame',\n\t\t\t\t\t\tclassName\n\t\t\t\t\t) }\n\t\t\t\t\tonRequestClose={ onRequestClose }\n\t\t\t\t\taria={ {\n\t\t\t\t\t\tlabelledby: title ? headingId : null,\n\t\t\t\t\t\tdescribedby: aria.describedby,\n\t\t\t\t\t} }\n\t\t\t\t\t{ ...otherProps }\n\t\t\t\t>\n\t\t\t\t\t<div className={ 'components-modal__content' } tabIndex=\"0\">\n\t\t\t\t\t\t<ModalHeader\n\t\t\t\t\t\t\tcloseLabel={ closeButtonLabel }\n\t\t\t\t\t\t\theadingId={ headingId }\n\t\t\t\t\t\t\ticon={ icon }\n\t\t\t\t\t\t\tisDismissable={ isDismissable }\n\t\t\t\t\t\t\tonClose={ onRequestClose }\n\t\t\t\t\t\t\ttitle={ title }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{ children }\n\t\t\t\t\t</div>\n\t\t\t\t</ModalFrame>\n\t\t\t</IsolatedEventContainer>,\n\t\t\tthis.node\n\t\t);\n\t\t/* eslint-enable jsx-a11y/no-static-element-interactions */\n\t}\n}\n\nModal.defaultProps = {\n\tbodyOpenClassName: 'modal-open',\n\trole: 'dialog',\n\ttitle: null,\n\tonRequestClose: noop,\n\tfocusOnMount: true,\n\tshouldCloseOnEsc: true,\n\tshouldCloseOnClickOutside: true,\n\tisDismissable: true,\n\t/* accessibility */\n\taria: {\n\t\tlabelledby: null,\n\t\tdescribedby: null,\n\t},\n};\n\nexport default withInstanceId( Modal );\n"]}