{"version":3,"sources":["/Users/riad/Workspace/a8c/gutenberg/packages/rich-text/src/replace.js"],"names":["replace","pattern","replacement","formats","text","start","end","match","rest","offset","length","newText","newFormats","Array","fill","slice","concat"],"mappings":";;;;;;;;;;;AAIA;;AAJA;;;;AAMA;;;;;;;;;;;;;;;;AAgBO,SAASA,OAAT,OAAiDC,OAAjD,EAA0DC,WAA1D,EAAwE;AAAA,MAApDC,OAAoD,QAApDA,OAAoD;AAAA,MAA3CC,IAA2C,QAA3CA,IAA2C;AAAA,MAArCC,KAAqC,QAArCA,KAAqC;AAAA,MAA9BC,GAA8B,QAA9BA,GAA8B;AAC9EF,EAAAA,IAAI,GAAGA,IAAI,CAACJ,OAAL,CAAcC,OAAd,EAAuB,UAAEM,KAAF,EAAsB;AAAA,sCAAVC,IAAU;AAAVA,MAAAA,IAAU;AAAA;;AACnD,QAAMC,MAAM,GAAGD,IAAI,CAAEA,IAAI,CAACE,MAAL,GAAc,CAAhB,CAAnB;AACA,QAAIC,OAAO,GAAGT,WAAd;AACA,QAAIU,UAAJ;;AAEA,QAAK,OAAOD,OAAP,KAAmB,UAAxB,EAAqC;AACpCA,MAAAA,OAAO,GAAGT,WAAW,MAAX,UAAaK,KAAb,SAAuBC,IAAvB,EAAV;AACA;;AAED,QAAK,sBAAOG,OAAP,MAAmB,QAAxB,EAAmC;AAClCC,MAAAA,UAAU,GAAGD,OAAO,CAACR,OAArB;AACAQ,MAAAA,OAAO,GAAGA,OAAO,CAACP,IAAlB;AACA,KAHD,MAGO;AACNQ,MAAAA,UAAU,GAAGC,KAAK,CAAEF,OAAO,CAACD,MAAV,CAAlB;;AAEA,UAAKP,OAAO,CAAEM,MAAF,CAAZ,EAAyB;AACxBG,QAAAA,UAAU,GAAGA,UAAU,CAACE,IAAX,CAAiBX,OAAO,CAAEM,MAAF,CAAxB,CAAb;AACA;AACD;;AAEDN,IAAAA,OAAO,GAAGA,OAAO,CAACY,KAAR,CAAe,CAAf,EAAkBN,MAAlB,EAA2BO,MAA3B,CAAmCJ,UAAnC,EAA+CT,OAAO,CAACY,KAAR,CAAeN,MAAM,GAAGF,KAAK,CAACG,MAA9B,CAA/C,CAAV;;AAEA,QAAKL,KAAL,EAAa;AACZA,MAAAA,KAAK,GAAGC,GAAG,GAAGG,MAAM,GAAGE,OAAO,CAACD,MAA/B;AACA;;AAED,WAAOC,OAAP;AACA,GA3BM,CAAP;AA6BA,SAAO,wCAAkB;AAAER,IAAAA,OAAO,EAAPA,OAAF;AAAWC,IAAAA,IAAI,EAAJA,IAAX;AAAiBC,IAAAA,KAAK,EAALA,KAAjB;AAAwBC,IAAAA,GAAG,EAAHA;AAAxB,GAAlB,CAAP;AACA","sourcesContent":["/**\n * Internal dependencies\n */\n\nimport { normaliseFormats } from './normalise-formats';\n\n/**\n * Search a Rich Text value and replace the match(es) with `replacement`. This\n * is similar to `String.prototype.replace`.\n *\n * @param {Object}         value        The value to modify.\n * @param {RegExp|string}  pattern      A RegExp object or literal. Can also be\n *                                      a string. It is treated as a verbatim\n *                                      string and is not interpreted as a\n *                                      regular expression. Only the first\n *                                      occurrence will be replaced.\n * @param {Function|string} replacement The match or matches are replaced with\n *                                      the specified or the value returned by\n *                                      the specified function.\n *\n * @return {Object} A new value with replacements applied.\n */\nexport function replace( { formats, text, start, end }, pattern, replacement ) {\n\ttext = text.replace( pattern, ( match, ...rest ) => {\n\t\tconst offset = rest[ rest.length - 2 ];\n\t\tlet newText = replacement;\n\t\tlet newFormats;\n\n\t\tif ( typeof newText === 'function' ) {\n\t\t\tnewText = replacement( match, ...rest );\n\t\t}\n\n\t\tif ( typeof newText === 'object' ) {\n\t\t\tnewFormats = newText.formats;\n\t\t\tnewText = newText.text;\n\t\t} else {\n\t\t\tnewFormats = Array( newText.length );\n\n\t\t\tif ( formats[ offset ] ) {\n\t\t\t\tnewFormats = newFormats.fill( formats[ offset ] );\n\t\t\t}\n\t\t}\n\n\t\tformats = formats.slice( 0, offset ).concat( newFormats, formats.slice( offset + match.length ) );\n\n\t\tif ( start ) {\n\t\t\tstart = end = offset + newText.length;\n\t\t}\n\n\t\treturn newText;\n\t} );\n\n\treturn normaliseFormats( { formats, text, start, end } );\n}\n"]}