{"version":3,"sources":["/Users/riad/Workspace/a8c/gutenberg/packages/compose/src/with-global-events/index.js"],"names":["forEach","Component","forwardRef","createHigherOrderComponent","Listener","listener","withGlobalEvents","eventTypesToHandlers","WrappedComponent","Wrapper","arguments","handleEvent","bind","handleRef","handler","eventType","add","remove","event","type","wrappedRef","el","props","forwardedRef","ownProps","ref"],"mappings":";;;;;;;;;AAAA;;;AAGA,SAASA,OAAT,QAAwB,QAAxB;AAEA;;;;AAGA,SAASC,SAAT,EAAoBC,UAApB,QAAsC,oBAAtC;AAEA;;;;AAGA,OAAOC,0BAAP,MAAuC,kCAAvC;AACA,OAAOC,QAAP,MAAqB,YAArB;AAEA;;;;;;AAKA,IAAMC,QAAQ,GAAG,IAAID,QAAJ,EAAjB;;AAEA,SAASE,gBAAT,CAA2BC,oBAA3B,EAAkD;AACjD,SAAOJ,0BAA0B,CAAE,UAAEK,gBAAF,EAAwB;AAAA,QACpDC,OADoD;AAAA;AAAA;AAAA;;AAEzD,yBAAc;AAAA;;AAAA;;AACb,sFAAUC,SAAV;AAEA,cAAKC,WAAL,GAAmB,MAAKA,WAAL,CAAiBC,IAAjB,uDAAnB;AACA,cAAKC,SAAL,GAAiB,MAAKA,SAAL,CAAeD,IAAf,uDAAjB;AAJa;AAKb;;AAPwD;AAAA;AAAA,4CASrC;AAAA;;AACnBZ,UAAAA,OAAO,CAAEO,oBAAF,EAAwB,UAAEO,OAAF,EAAWC,SAAX,EAA0B;AACxDV,YAAAA,QAAQ,CAACW,GAAT,CAAcD,SAAd,EAAyB,MAAzB;AACA,WAFM,CAAP;AAGA;AAbwD;AAAA;AAAA,+CAelC;AAAA;;AACtBf,UAAAA,OAAO,CAAEO,oBAAF,EAAwB,UAAEO,OAAF,EAAWC,SAAX,EAA0B;AACxDV,YAAAA,QAAQ,CAACY,MAAT,CAAiBF,SAAjB,EAA4B,MAA5B;AACA,WAFM,CAAP;AAGA;AAnBwD;AAAA;AAAA,oCAqB5CG,KArB4C,EAqBpC;AACpB,cAAMJ,OAAO,GAAGP,oBAAoB,CAAEW,KAAK,CAACC,IAAR,CAApC;;AACA,cAAK,OAAO,KAAKC,UAAL,CAAiBN,OAAjB,CAAP,KAAsC,UAA3C,EAAwD;AACvD,iBAAKM,UAAL,CAAiBN,OAAjB,EAA4BI,KAA5B;AACA;AACD;AA1BwD;AAAA;AAAA,kCA4B9CG,EA5B8C,EA4BzC;AACf,eAAKD,UAAL,GAAkBC,EAAlB,CADe,CAEf;AACA;AACA;;AACA,cAAK,KAAKC,KAAL,CAAWC,YAAhB,EAA+B;AAC9B,iBAAKD,KAAL,CAAWC,YAAX,CAAyBF,EAAzB;AACA;AACD;AApCwD;AAAA;AAAA,iCAsChD;AACR,iBAAO,cAAC,gBAAD,eAAuB,KAAKC,KAAL,CAAWE,QAAlC;AAA6C,YAAA,GAAG,EAAG,KAAKX;AAAxD,aAAP;AACA;AAxCwD;;AAAA;AAAA,MACpCZ,SADoC;;AA2C1D,WAAOC,UAAU,CAAE,UAAEoB,KAAF,EAASG,GAAT,EAAkB;AACpC,aAAO,cAAC,OAAD;AAAS,QAAA,QAAQ,EAAGH,KAApB;AAA4B,QAAA,YAAY,EAAGG;AAA3C,QAAP;AACA,KAFgB,CAAjB;AAGA,GA9CgC,EA8C9B,kBA9C8B,CAAjC;AA+CA;;AAED,eAAenB,gBAAf","sourcesContent":["/**\n * External dependencies\n */\nimport { forEach } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { Component, forwardRef } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport createHigherOrderComponent from '../create-higher-order-component';\nimport Listener from './listener';\n\n/**\n * Listener instance responsible for managing document event handling.\n *\n * @type {Listener}\n */\nconst listener = new Listener();\n\nfunction withGlobalEvents( eventTypesToHandlers ) {\n\treturn createHigherOrderComponent( ( WrappedComponent ) => {\n\t\tclass Wrapper extends Component {\n\t\t\tconstructor() {\n\t\t\t\tsuper( ...arguments );\n\n\t\t\t\tthis.handleEvent = this.handleEvent.bind( this );\n\t\t\t\tthis.handleRef = this.handleRef.bind( this );\n\t\t\t}\n\n\t\t\tcomponentDidMount() {\n\t\t\t\tforEach( eventTypesToHandlers, ( handler, eventType ) => {\n\t\t\t\t\tlistener.add( eventType, this );\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\tcomponentWillUnmount() {\n\t\t\t\tforEach( eventTypesToHandlers, ( handler, eventType ) => {\n\t\t\t\t\tlistener.remove( eventType, this );\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\thandleEvent( event ) {\n\t\t\t\tconst handler = eventTypesToHandlers[ event.type ];\n\t\t\t\tif ( typeof this.wrappedRef[ handler ] === 'function' ) {\n\t\t\t\t\tthis.wrappedRef[ handler ]( event );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\thandleRef( el ) {\n\t\t\t\tthis.wrappedRef = el;\n\t\t\t\t// Any component using `withGlobalEvents` that is not setting a `ref`\n\t\t\t\t// will cause `this.props.forwardedRef` to be `null`, so we need this\n\t\t\t\t// check.\n\t\t\t\tif ( this.props.forwardedRef ) {\n\t\t\t\t\tthis.props.forwardedRef( el );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trender() {\n\t\t\t\treturn <WrappedComponent { ...this.props.ownProps } ref={ this.handleRef } />;\n\t\t\t}\n\t\t}\n\n\t\treturn forwardRef( ( props, ref ) => {\n\t\t\treturn <Wrapper ownProps={ props } forwardedRef={ ref } />;\n\t\t} );\n\t}, 'withGlobalEvents' );\n}\n\nexport default withGlobalEvents;\n"]}