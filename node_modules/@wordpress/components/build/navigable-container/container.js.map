{"version":3,"sources":["/Users/riad/Workspace/a8c/gutenberg/packages/components/src/navigable-container/container.js"],"names":["cycleValue","value","total","offset","nextValue","NavigableContainer","arguments","onKeyDown","bind","bindContainer","getFocusableContext","getFocusableIndex","ref","forwardedRef","props","container","current","target","onlyBrowserTabstops","finder","focus","tabbable","focusable","focusables","find","index","directIndex","indexOf","event","cycle","eventToOffset","onNavigate","noop","stopNavigationEvents","undefined","nativeEvent","stopImmediatePropagation","getAttribute","preventDefault","stopPropagation","context","document","activeElement","nextIndex","length","children","onFocus","Component","forwardedNavigableContainer","displayName"],"mappings":"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","sourcesContent":["/**\n * External Dependencies\n */\nimport { omit, noop, isFunction } from 'lodash';\n\n/**\n * WordPress Dependencies\n */\nimport { Component, forwardRef } from '@wordpress/element';\nimport { focus } from '@wordpress/dom';\n\nfunction cycleValue( value, total, offset ) {\n\tconst nextValue = value + offset;\n\tif ( nextValue < 0 ) {\n\t\treturn total + nextValue;\n\t} else if ( nextValue >= total ) {\n\t\treturn nextValue - total;\n\t}\n\n\treturn nextValue;\n}\n\nclass NavigableContainer extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.onKeyDown = this.onKeyDown.bind( this );\n\t\tthis.bindContainer = this.bindContainer.bind( this );\n\n\t\tthis.getFocusableContext = this.getFocusableContext.bind( this );\n\t\tthis.getFocusableIndex = this.getFocusableIndex.bind( this );\n\t}\n\n\tbindContainer( ref ) {\n\t\tconst { forwardedRef } = this.props;\n\t\tthis.container = ref;\n\n\t\tif ( isFunction( forwardedRef ) ) {\n\t\t\tforwardedRef( ref );\n\t\t} else if ( forwardedRef && 'current' in forwardedRef ) {\n\t\t\tforwardedRef.current = ref;\n\t\t}\n\t}\n\n\tgetFocusableContext( target ) {\n\t\tconst { onlyBrowserTabstops } = this.props;\n\t\tconst finder = onlyBrowserTabstops ? focus.tabbable : focus.focusable;\n\t\tconst focusables = finder.find( this.container );\n\n\t\tconst index = this.getFocusableIndex( focusables, target );\n\t\tif ( index > -1 && target ) {\n\t\t\treturn { index, target, focusables };\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetFocusableIndex( focusables, target ) {\n\t\tconst directIndex = focusables.indexOf( target );\n\t\tif ( directIndex !== -1 ) {\n\t\t\treturn directIndex;\n\t\t}\n\t}\n\n\tonKeyDown( event ) {\n\t\tif ( this.props.onKeyDown ) {\n\t\t\tthis.props.onKeyDown( event );\n\t\t}\n\n\t\tconst { getFocusableContext } = this;\n\t\tconst { cycle = true, eventToOffset, onNavigate = noop, stopNavigationEvents } = this.props;\n\n\t\tconst offset = eventToOffset( event );\n\n\t\t// eventToOffset returns undefined if the event is not handled by the component\n\t\tif ( offset !== undefined && stopNavigationEvents ) {\n\t\t\t// Prevents arrow key handlers bound to the document directly interfering\n\t\t\tevent.nativeEvent.stopImmediatePropagation();\n\n\t\t\t// When navigating a collection of items, prevent scroll containers\n\t\t\t// from scrolling.\n\t\t\tif ( event.target.getAttribute( 'role' ) === 'menuitem' ) {\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\n\t\t\tevent.stopPropagation();\n\t\t}\n\n\t\tif ( ! offset ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst context = getFocusableContext( document.activeElement );\n\t\tif ( ! context ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { index, focusables } = context;\n\t\tconst nextIndex = cycle ? cycleValue( index, focusables.length, offset ) : index + offset;\n\t\tif ( nextIndex >= 0 && nextIndex < focusables.length ) {\n\t\t\tfocusables[ nextIndex ].focus();\n\t\t\tonNavigate( nextIndex, focusables[ nextIndex ] );\n\t\t}\n\t}\n\n\trender() {\n\t\tconst { children, ...props } = this.props;\n\t\t// Disable reason: Assumed role is applied by parent via props spread.\n\t\t/* eslint-disable jsx-a11y/no-static-element-interactions */\n\t\treturn (\n\t\t\t<div ref={ this.bindContainer }\n\t\t\t\t{ ...omit( props, [\n\t\t\t\t\t'stopNavigationEvents',\n\t\t\t\t\t'eventToOffset',\n\t\t\t\t\t'onNavigate',\n\t\t\t\t\t'cycle',\n\t\t\t\t\t'onlyBrowserTabstops',\n\t\t\t\t\t'forwardedRef',\n\t\t\t\t] ) }\n\t\t\t\tonKeyDown={ this.onKeyDown }\n\t\t\t\tonFocus={ this.onFocus }>\n\t\t\t\t{ children }\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nconst forwardedNavigableContainer = ( props, ref ) => {\n\treturn <NavigableContainer { ...props } forwardedRef={ ref } />;\n};\nforwardedNavigableContainer.displayName = 'NavigableContainer';\n\nexport default forwardRef( forwardedNavigableContainer );\n"]}