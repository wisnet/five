{"version":3,"sources":["/Users/riad/Workspace/a8c/gutenberg/packages/components/src/modal/frame.js"],"names":["Component","createRef","ESCAPE","focus","withGlobalEvents","compose","clickOutside","withFocusReturn","withConstrainedTabbing","ModalFrame","arguments","containerRef","handleKeyDown","bind","handleClickOutside","focusFirstTabbable","props","focusOnMount","tabbables","tabbable","find","current","length","event","shouldCloseOnClickOutside","onRequestClose","keyCode","handleEscapeKeyDown","shouldCloseOnEsc","preventDefault","contentLabel","aria","describedby","labelledby","children","className","role","style","keydown"],"mappings":";;;;;;;;AAAA;;;AAGA,SAASA,SAAT,EAAoBC,SAApB,QAAqC,oBAArC;AACA,SAASC,MAAT,QAAuB,qBAAvB;AACA,SAASC,KAAT,QAAsB,gBAAtB;AACA,SAASC,gBAAT,EAA2BC,OAA3B,QAA0C,oBAA1C;AAEA;;;;AAGA,OAAOC,YAAP,MAAyB,qBAAzB;AAEA;;;;AAGA,OAAOC,eAAP,MAA4B,mCAA5B;AACA,OAAOC,sBAAP,MAAmC,0CAAnC;;IAEMC,U;;;;;AACL,wBAAc;AAAA;;AAAA;;AACb,qFAAUC,SAAV;AAEA,UAAKC,YAAL,GAAoBV,SAAS,EAA7B;AACA,UAAKW,aAAL,GAAqB,MAAKA,aAAL,CAAmBC,IAAnB,uDAArB;AACA,UAAKC,kBAAL,GAA0B,MAAKA,kBAAL,CAAwBD,IAAxB,uDAA1B;AACA,UAAKE,kBAAL,GAA0B,MAAKA,kBAAL,CAAwBF,IAAxB,uDAA1B;AANa;AAOb;AAED;;;;;;;wCAGoB;AACnB;AACA,UAAK,KAAKG,KAAL,CAAWC,YAAhB,EAA+B;AAC9B,aAAKF,kBAAL;AACA;AACD;AAED;;;;;;yCAGqB;AACpB,UAAMG,SAAS,GAAGf,KAAK,CAACgB,QAAN,CAAeC,IAAf,CAAqB,KAAKT,YAAL,CAAkBU,OAAvC,CAAlB;;AACA,UAAKH,SAAS,CAACI,MAAf,EAAwB;AACvBJ,QAAAA,SAAS,CAAE,CAAF,CAAT,CAAef,KAAf;AACA;AACD;AAED;;;;;;;;uCAKoBoB,K,EAAQ;AAC3B,UAAK,KAAKP,KAAL,CAAWQ,yBAAhB,EAA4C;AAC3C,aAAKC,cAAL,CAAqBF,KAArB;AACA;AACD;AAED;;;;;;;;kCAKeA,K,EAAQ;AACtB,UAAKA,KAAK,CAACG,OAAN,KAAkBxB,MAAvB,EAAgC;AAC/B,aAAKyB,mBAAL,CAA0BJ,KAA1B;AACA;AACD;AAED;;;;;;;;;;wCAOqBA,K,EAAQ;AAC5B,UAAK,KAAKP,KAAL,CAAWY,gBAAhB,EAAmC;AAClCL,QAAAA,KAAK,CAACM,cAAN;AACA,aAAKJ,cAAL,CAAqBF,KAArB;AACA;AACD;AAED;;;;;;;;mCAKgBA,K,EAAQ;AAAA,UACfE,cADe,GACI,KAAKT,KADT,CACfS,cADe;;AAEvB,UAAKA,cAAL,EAAsB;AACrBA,QAAAA,cAAc,CAAEF,KAAF,CAAd;AACA;AACD;AAED;;;;;;;;6BAKS;AAAA,wBAWJ,KAAKP,KAXD;AAAA,UAEPc,YAFO,eAEPA,YAFO;AAAA,yCAGPC,IAHO;AAAA,UAINC,WAJM,oBAINA,WAJM;AAAA,UAKNC,UALM,oBAKNA,UALM;AAAA,UAOPC,QAPO,eAOPA,QAPO;AAAA,UAQPC,SARO,eAQPA,SARO;AAAA,UASPC,IATO,eASPA,IATO;AAAA,UAUPC,KAVO,eAUPA,KAVO;AAaR,aACC;AACC,QAAA,SAAS,EAAGF,SADb;AAEC,QAAA,KAAK,EAAGE,KAFT;AAGC,QAAA,GAAG,EAAG,KAAK1B,YAHZ;AAIC,QAAA,IAAI,EAAGyB,IAJR;AAKC,sBAAaN,YALd;AAMC,2BAAkBA,YAAY,GAAG,IAAH,GAAUG,UANzC;AAOC,4BAAmBD,WAPpB;AAQC,QAAA,QAAQ,EAAC;AARV,SAUGE,QAVH,CADD;AAcA;;;;EA9GuBlC,S;;AAiHzB,eAAeK,OAAO,CAAE,CACvBE,eADuB,EAEvBC,sBAFuB,EAGvBF,YAHuB,EAIvBF,gBAAgB,CAAE;AACjBkC,EAAAA,OAAO,EAAE;AADQ,CAAF,CAJO,CAAF,CAAP,CAOV7B,UAPU,CAAf","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { Component, createRef } from '@wordpress/element';\nimport { ESCAPE } from '@wordpress/keycodes';\nimport { focus } from '@wordpress/dom';\nimport { withGlobalEvents, compose } from '@wordpress/compose';\n\n/**\n * External dependencies\n */\nimport clickOutside from 'react-click-outside';\n\n/**\n * Internal dependencies\n */\nimport withFocusReturn from '../higher-order/with-focus-return';\nimport withConstrainedTabbing from '../higher-order/with-constrained-tabbing';\n\nclass ModalFrame extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.containerRef = createRef();\n\t\tthis.handleKeyDown = this.handleKeyDown.bind( this );\n\t\tthis.handleClickOutside = this.handleClickOutside.bind( this );\n\t\tthis.focusFirstTabbable = this.focusFirstTabbable.bind( this );\n\t}\n\n\t/**\n\t * Focuses the first tabbable element when props.focusOnMount is true.\n\t */\n\tcomponentDidMount() {\n\t\t// Focus on mount\n\t\tif ( this.props.focusOnMount ) {\n\t\t\tthis.focusFirstTabbable();\n\t\t}\n\t}\n\n\t/**\n\t * Focuses the first tabbable element.\n\t */\n\tfocusFirstTabbable() {\n\t\tconst tabbables = focus.tabbable.find( this.containerRef.current );\n\t\tif ( tabbables.length ) {\n\t\t\ttabbables[ 0 ].focus();\n\t\t}\n\t}\n\n\t/**\n\t * Callback function called when clicked outside the modal.\n\t *\n\t * @param {Object} event Mouse click event.\n\t */\n\thandleClickOutside( event ) {\n\t\tif ( this.props.shouldCloseOnClickOutside ) {\n\t\t\tthis.onRequestClose( event );\n\t\t}\n\t}\n\n\t/**\n\t * Callback function called when a key is pressed.\n\t *\n\t * @param {KeyboardEvent} event Key down event.\n\t */\n\thandleKeyDown( event ) {\n\t\tif ( event.keyCode === ESCAPE ) {\n\t\t\tthis.handleEscapeKeyDown( event );\n\t\t}\n\t}\n\n\t/**\n\t * Handles a escape key down event.\n\t *\n\t * Calls onRequestClose and prevents default key press behaviour.\n\t *\n\t * @param {Object} event Key down event.\n\t */\n\thandleEscapeKeyDown( event ) {\n\t\tif ( this.props.shouldCloseOnEsc ) {\n\t\t\tevent.preventDefault();\n\t\t\tthis.onRequestClose( event );\n\t\t}\n\t}\n\n\t/**\n\t * Calls the onRequestClose callback props when it is available.\n\t *\n\t * @param {Object} event Event object.\n\t */\n\tonRequestClose( event ) {\n\t\tconst { onRequestClose } = this.props;\n\t\tif ( onRequestClose ) {\n\t\t\tonRequestClose( event );\n\t\t}\n\t}\n\n\t/**\n\t * Renders the modal frame element.\n\t *\n\t * @return {WPElement} The modal frame element.\n\t */\n\trender() {\n\t\tconst {\n\t\t\tcontentLabel,\n\t\t\taria: {\n\t\t\t\tdescribedby,\n\t\t\t\tlabelledby,\n\t\t\t},\n\t\t\tchildren,\n\t\t\tclassName,\n\t\t\trole,\n\t\t\tstyle,\n\t\t} = this.props;\n\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName={ className }\n\t\t\t\tstyle={ style }\n\t\t\t\tref={ this.containerRef }\n\t\t\t\trole={ role }\n\t\t\t\taria-label={ contentLabel }\n\t\t\t\taria-labelledby={ contentLabel ? null : labelledby }\n\t\t\t\taria-describedby={ describedby }\n\t\t\t\ttabIndex=\"-1\"\n\t\t\t>\n\t\t\t\t{ children }\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default compose( [\n\twithFocusReturn,\n\twithConstrainedTabbing,\n\tclickOutside,\n\twithGlobalEvents( {\n\t\tkeydown: 'handleKeyDown',\n\t} ),\n] )( ModalFrame );\n"]}