{"version":3,"sources":["/Users/riad/Workspace/a8c/gutenberg/packages/rich-text/src/split.js"],"names":["split","string","formats","text","start","end","splitAtSelection","arguments","nextStart","map","substring","startIndex","value","slice","length","undefined","endIndex","before","after"],"mappings":";;;;;;;AAIA;;AAJA;;;;AAMA;;;;;;;;;;;AAWO,SAASA,KAAT,OAA+CC,MAA/C,EAAwD;AAAA,MAAtCC,OAAsC,QAAtCA,OAAsC;AAAA,MAA7BC,IAA6B,QAA7BA,IAA6B;AAAA,MAAvBC,KAAuB,QAAvBA,KAAuB;AAAA,MAAhBC,GAAgB,QAAhBA,GAAgB;;AAC9D,MAAK,OAAOJ,MAAP,KAAkB,QAAvB,EAAkC;AACjC,WAAOK,gBAAgB,MAAhB,SAAqBC,SAArB,CAAP;AACA;;AAED,MAAIC,SAAS,GAAG,CAAhB;AAEA,SAAOL,IAAI,CAACH,KAAL,CAAYC,MAAZ,EAAqBQ,GAArB,CAA0B,UAAEC,SAAF,EAAiB;AACjD,QAAMC,UAAU,GAAGH,SAAnB;AACA,QAAMI,KAAK,GAAG;AACbV,MAAAA,OAAO,EAAEA,OAAO,CAACW,KAAR,CAAeF,UAAf,EAA2BA,UAAU,GAAGD,SAAS,CAACI,MAAlD,CADI;AAEbX,MAAAA,IAAI,EAAEO;AAFO,KAAd;AAKAF,IAAAA,SAAS,IAAIP,MAAM,CAACa,MAAP,GAAgBJ,SAAS,CAACI,MAAvC;;AAEA,QAAKV,KAAK,KAAKW,SAAV,IAAuBV,GAAG,KAAKU,SAApC,EAAgD;AAC/C,UAAKX,KAAK,IAAIO,UAAT,IAAuBP,KAAK,GAAGI,SAApC,EAAgD;AAC/CI,QAAAA,KAAK,CAACR,KAAN,GAAcA,KAAK,GAAGO,UAAtB;AACA,OAFD,MAEO,IAAKP,KAAK,GAAGO,UAAR,IAAsBN,GAAG,GAAGM,UAAjC,EAA8C;AACpDC,QAAAA,KAAK,CAACR,KAAN,GAAc,CAAd;AACA;;AAED,UAAKC,GAAG,IAAIM,UAAP,IAAqBN,GAAG,GAAGG,SAAhC,EAA4C;AAC3CI,QAAAA,KAAK,CAACP,GAAN,GAAYA,GAAG,GAAGM,UAAlB;AACA,OAFD,MAEO,IAAKP,KAAK,GAAGI,SAAR,IAAqBH,GAAG,GAAGG,SAAhC,EAA4C;AAClDI,QAAAA,KAAK,CAACP,GAAN,GAAYK,SAAS,CAACI,MAAtB;AACA;AACD;;AAED,WAAOF,KAAP;AACA,GAxBM,CAAP;AAyBA;;AAED,SAASN,gBAAT,QAIE;AAAA,MAHCJ,OAGD,SAHCA,OAGD;AAAA,MAHUC,IAGV,SAHUA,IAGV;AAAA,MAHgBC,KAGhB,SAHgBA,KAGhB;AAAA,MAHuBC,GAGvB,SAHuBA,GAGvB;AAAA,MAFDM,UAEC,uEAFYP,KAEZ;AAAA,MADDY,QACC,uEADUX,GACV;AACD,MAAMY,MAAM,GAAG;AACdf,IAAAA,OAAO,EAAEA,OAAO,CAACW,KAAR,CAAe,CAAf,EAAkBF,UAAlB,CADK;AAEdR,IAAAA,IAAI,EAAEA,IAAI,CAACU,KAAL,CAAY,CAAZ,EAAeF,UAAf;AAFQ,GAAf;AAIA,MAAMO,KAAK,GAAG;AACbhB,IAAAA,OAAO,EAAEA,OAAO,CAACW,KAAR,CAAeG,QAAf,CADI;AAEbb,IAAAA,IAAI,EAAEA,IAAI,CAACU,KAAL,CAAYG,QAAZ,CAFO;AAGbZ,IAAAA,KAAK,EAAE,CAHM;AAIbC,IAAAA,GAAG,EAAE;AAJQ,GAAd;AAOA,SAAO,CACN;AACA,wBAASY,MAAT,EAAiB,UAAjB,EAA6B,EAA7B,CAFM,EAGN,sBAASC,KAAT,EAAgB,UAAhB,EAA4B,EAA5B,CAHM,CAAP;AAKA","sourcesContent":["/**\n * Internal dependencies\n */\n\nimport { replace } from './replace';\n\n/**\n * Split a Rich Text value in two at the given `startIndex` and `endIndex`, or\n * split at the given separator. This is similar to `String.prototype.split`.\n * Indices are retrieved from the selection if none are provided.\n *\n * @param {Object}        value   Value to modify.\n * @param {number|string} string  Start index, or string at which to split.\n * @param {number}        end     End index.\n *\n * @return {Array} An array of new values.\n */\nexport function split( { formats, text, start, end }, string ) {\n\tif ( typeof string !== 'string' ) {\n\t\treturn splitAtSelection( ...arguments );\n\t}\n\n\tlet nextStart = 0;\n\n\treturn text.split( string ).map( ( substring ) => {\n\t\tconst startIndex = nextStart;\n\t\tconst value = {\n\t\t\tformats: formats.slice( startIndex, startIndex + substring.length ),\n\t\t\ttext: substring,\n\t\t};\n\n\t\tnextStart += string.length + substring.length;\n\n\t\tif ( start !== undefined && end !== undefined ) {\n\t\t\tif ( start >= startIndex && start < nextStart ) {\n\t\t\t\tvalue.start = start - startIndex;\n\t\t\t} else if ( start < startIndex && end > startIndex ) {\n\t\t\t\tvalue.start = 0;\n\t\t\t}\n\n\t\t\tif ( end >= startIndex && end < nextStart ) {\n\t\t\t\tvalue.end = end - startIndex;\n\t\t\t} else if ( start < nextStart && end > nextStart ) {\n\t\t\t\tvalue.end = substring.length;\n\t\t\t}\n\t\t}\n\n\t\treturn value;\n\t} );\n}\n\nfunction splitAtSelection(\n\t{ formats, text, start, end },\n\tstartIndex = start,\n\tendIndex = end\n) {\n\tconst before = {\n\t\tformats: formats.slice( 0, startIndex ),\n\t\ttext: text.slice( 0, startIndex ),\n\t};\n\tconst after = {\n\t\tformats: formats.slice( endIndex ),\n\t\ttext: text.slice( endIndex ),\n\t\tstart: 0,\n\t\tend: 0,\n\t};\n\n\treturn [\n\t\t// Ensure newlines are trimmed.\n\t\treplace( before, /\\u2028+$/, '' ),\n\t\treplace( after, /^\\u2028+/, '' ),\n\t];\n}\n"]}