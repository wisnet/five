{"version":3,"sources":["/Users/riad/Workspace/a8c/gutenberg/packages/components/src/higher-order/with-constrained-tabbing/index.js"],"names":["withConstrainedTabbing","WrappedComponent","arguments","focusContainRef","handleTabBehaviour","bind","event","keyCode","TAB","tabbables","focus","tabbable","find","current","length","firstTabbable","lastTabbable","shiftKey","target","preventDefault","includes","props","Component"],"mappings":";;;;;;;;;AAGA;;;;;;;;;;;;;;AACA;;AACA;;AACA;;AANA;;;AAQA,IAAMA,sBAAsB,GAAG,yCAC9B,UAAEC,gBAAF;AAAA;AAAA;AAAA;AAAA;;AACC,wBAAc;AAAA;;AAAA;AACb,iHAAUC,SAAV;AAEA,cAAKC,eAAL,GAAuB,yBAAvB;AACA,cAAKC,kBAAL,GAA0B,MAAKA,kBAAL,CAAwBC,IAAxB,mFAA1B;AAJa;AAKb;;AANF;AAAA;AAAA,2CAQqBC,KARrB,EAQ6B;AAC3B,cAAKA,KAAK,CAACC,OAAN,KAAkBC,aAAvB,EAA6B;AAC5B;AACA;;AAED,cAAMC,SAAS,GAAGC,WAAMC,QAAN,CAAeC,IAAf,CAAqB,KAAKT,eAAL,CAAqBU,OAA1C,CAAlB;;AACA,cAAK,CAAEJ,SAAS,CAACK,MAAjB,EAA0B;AACzB;AACA;;AACD,cAAMC,aAAa,GAAGN,SAAS,CAAE,CAAF,CAA/B;AACA,cAAMO,YAAY,GAAGP,SAAS,CAAEA,SAAS,CAACK,MAAV,GAAmB,CAArB,CAA9B;;AAEA,cAAKR,KAAK,CAACW,QAAN,IAAkBX,KAAK,CAACY,MAAN,KAAiBH,aAAxC,EAAwD;AACvDT,YAAAA,KAAK,CAACa,cAAN;AACAH,YAAAA,YAAY,CAACN,KAAb;AACA,WAHD,MAGO,IAAK,CAAEJ,KAAK,CAACW,QAAR,IAAoBX,KAAK,CAACY,MAAN,KAAiBF,YAA1C,EAAyD;AAC/DV,YAAAA,KAAK,CAACa,cAAN;AACAJ,YAAAA,aAAa,CAACL,KAAd;AACD;;;;AAIC,WAPM,MAOA,IAAK,CAAED,SAAS,CAACW,QAAV,CAAoBd,KAAK,CAACY,MAA1B,CAAP,EAA4C;AAClDZ,YAAAA,KAAK,CAACa,cAAN;AACAJ,YAAAA,aAAa,CAACL,KAAd;AACA;AACD;AAlCF;AAAA;AAAA,iCAoCU;AACR;AACA;;AACA;AACA,iBACC;AACC,YAAA,SAAS,EAAG,KAAKN,kBADlB;AAEC,YAAA,GAAG,EAAG,KAAKD,eAFZ;AAGC,YAAA,QAAQ,EAAC;AAHV,aAKC,4BAAC,gBAAD,EAAuB,KAAKkB,KAA5B,CALD,CADD;AASA;AACA;AAlDF;AAAA;AAAA,MAAsCC,kBAAtC;AAAA;AAAA,CAD8B,EAqD9B,wBArD8B,CAA/B;eAwDetB,sB","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { Component, createRef } from '@wordpress/element';\nimport { createHigherOrderComponent } from '@wordpress/compose';\nimport { TAB } from '@wordpress/keycodes';\nimport { focus } from '@wordpress/dom';\n\nconst withConstrainedTabbing = createHigherOrderComponent(\n\t( WrappedComponent ) => class extends Component {\n\t\tconstructor() {\n\t\t\tsuper( ...arguments );\n\n\t\t\tthis.focusContainRef = createRef();\n\t\t\tthis.handleTabBehaviour = this.handleTabBehaviour.bind( this );\n\t\t}\n\n\t\thandleTabBehaviour( event ) {\n\t\t\tif ( event.keyCode !== TAB ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst tabbables = focus.tabbable.find( this.focusContainRef.current );\n\t\t\tif ( ! tabbables.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst firstTabbable = tabbables[ 0 ];\n\t\t\tconst lastTabbable = tabbables[ tabbables.length - 1 ];\n\n\t\t\tif ( event.shiftKey && event.target === firstTabbable ) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tlastTabbable.focus();\n\t\t\t} else if ( ! event.shiftKey && event.target === lastTabbable ) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tfirstTabbable.focus();\n\t\t\t/*\n\t\t\t * When pressing Tab and none of the tabbables has focus, the keydown\n\t\t\t * event happens on the wrapper div: move focus on the first tabbable.\n\t\t\t */\n\t\t\t} else if ( ! tabbables.includes( event.target ) ) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tfirstTabbable.focus();\n\t\t\t}\n\t\t}\n\n\t\trender() {\n\t\t\t// Disable reason: this component is non-interactive, but must capture\n\t\t\t// events from the wrapped component to determine when the Tab key is used.\n\t\t\t/* eslint-disable jsx-a11y/no-static-element-interactions */\n\t\t\treturn (\n\t\t\t\t<div\n\t\t\t\t\tonKeyDown={ this.handleTabBehaviour }\n\t\t\t\t\tref={ this.focusContainRef }\n\t\t\t\t\ttabIndex=\"-1\"\n\t\t\t\t>\n\t\t\t\t\t<WrappedComponent { ...this.props } />\n\t\t\t\t</div>\n\t\t\t);\n\t\t\t/* eslint-enable jsx-a11y/no-static-element-interactions */\n\t\t}\n\t},\n\t'withConstrainedTabbing'\n);\n\nexport default withConstrainedTabbing;\n"]}