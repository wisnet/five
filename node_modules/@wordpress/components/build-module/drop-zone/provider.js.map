{"version":3,"sources":["/Users/riad/Workspace/a8c/gutenberg/packages/components/src/drop-zone/provider.js"],"names":["isEqual","find","some","filter","throttle","includes","Component","createContext","isShallowEqual","addDropZone","removeDropZone","Provider","Consumer","getDragEventType","dataTransfer","types","isTypeSupportedByDropZone","type","dropZone","onFilesDrop","onHTMLDrop","onDrop","isWithinElementBounds","element","x","y","rect","getBoundingClientRect","bottom","top","left","right","DropZoneProvider","arguments","onDragOver","bind","resetDragState","toggleDraggingOverDocument","dropZones","dropZoneCallbacks","state","hoveredDropZone","isDraggingOverDocument","isDraggingOverElement","position","window","addEventListener","removeEventListener","push","dz","cancel","setState","forEach","event","dragEventType","detail","CustomEvent","hoveredDropZones","clientX","clientY","zone","subZone","parentElement","contains","hoveredDropZoneIndex","indexOf","toUpdate","map","index","isDraggingOverDropZone","newState","preventDefault","files","length","getData","stopPropagation","props","children","DropZoneConsumer"],"mappings":";;;;;;;;;AAAA;;;AAGA,SAASA,OAAT,EAAkBC,IAAlB,EAAwBC,IAAxB,EAA8BC,MAA9B,EAAsCC,QAAtC,EAAgDC,QAAhD,QAAgE,QAAhE;AAEA;;;;AAGA,SAASC,SAAT,EAAoBC,aAApB,QAAyC,oBAAzC;AACA,OAAOC,cAAP,MAA2B,6BAA3B;;qBAE+BD,aAAa,CAAE;AAC7CE,EAAAA,WAAW,EAAE,uBAAM,CAAE,CADwB;AAE7CC,EAAAA,cAAc,EAAE,0BAAM,CAAE;AAFqB,CAAF,C;IAApCC,Q,kBAAAA,Q;IAAUC,Q,kBAAAA,Q;;AAKlB,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,OAAwB;AAAA,MAApBC,YAAoB,QAApBA,YAAoB;;AAChD,MAAKA,YAAL,EAAoB;AACnB;AACA;AACA;AACA,QAAKT,QAAQ,CAAES,YAAY,CAACC,KAAf,EAAsB,OAAtB,CAAb,EAA+C;AAC9C,aAAO,MAAP;AACA;;AAED,QAAKV,QAAQ,CAAES,YAAY,CAACC,KAAf,EAAsB,WAAtB,CAAb,EAAmD;AAClD,aAAO,MAAP;AACA;AACD;;AAED,SAAO,SAAP;AACA,CAfD;;AAiBA,IAAMC,yBAAyB,GAAG,SAA5BA,yBAA4B,CAAEC,IAAF,EAAQC,QAAR,EAAsB;AACvD,SAASD,IAAI,KAAK,MAAT,IAAmBC,QAAQ,CAACC,WAA9B,IACJF,IAAI,KAAK,MAAT,IAAmBC,QAAQ,CAACE,UADxB,IAEJH,IAAI,KAAK,SAAT,IAAsBC,QAAQ,CAACG,MAFlC;AAGA,CAJD;;AAMA,IAAMC,qBAAqB,GAAG,SAAxBA,qBAAwB,CAAEC,OAAF,EAAWC,CAAX,EAAcC,CAAd,EAAqB;AAClD,MAAMC,IAAI,GAAGH,OAAO,CAACI,qBAAR,EAAb,CADkD,CAElD;;AACA,MAAKD,IAAI,CAACE,MAAL,KAAgBF,IAAI,CAACG,GAArB,IAA4BH,IAAI,CAACI,IAAL,KAAcJ,IAAI,CAACK,KAApD,EAA4D;AAC3D,WAAO,KAAP;AACA;;AAED,SAAOP,CAAC,IAAIE,IAAI,CAACI,IAAV,IAAkBN,CAAC,IAAIE,IAAI,CAACK,KAA5B,IAAqCN,CAAC,IAAIC,IAAI,CAACG,GAA/C,IAAsDJ,CAAC,IAAIC,IAAI,CAACE,MAAvE;AACA,CARD;;IAUMI,gB;;;;;AACL,8BAAc;AAAA;;AAAA;;AACb,2FAAUC,SAAV,GADa,CAGb;;AACA,UAAKC,UAAL,GAAkB,MAAKA,UAAL,CAAgBC,IAAhB,uDAAlB;AACA,UAAKd,MAAL,GAAc,MAAKA,MAAL,CAAYc,IAAZ,uDAAd,CALa,CAMb;;AACA,UAAK1B,WAAL,GAAmB,MAAKA,WAAL,CAAiB0B,IAAjB,uDAAnB;AACA,UAAKzB,cAAL,GAAsB,MAAKA,cAAL,CAAoByB,IAApB,uDAAtB,CARa,CASb;;AACA,UAAKC,cAAL,GAAsB,MAAKA,cAAL,CAAoBD,IAApB,uDAAtB;AACA,UAAKE,0BAAL,GAAkCjC,QAAQ,CAAE,MAAKiC,0BAAL,CAAgCF,IAAhC,uDAAF,EAAgD,GAAhD,CAA1C;AAEA,UAAKG,SAAL,GAAiB,EAAjB;AACA,UAAKC,iBAAL,GAAyB;AACxB9B,MAAAA,WAAW,EAAE,MAAKA,WADM;AAExBC,MAAAA,cAAc,EAAE,MAAKA;AAFG,KAAzB;AAIA,UAAK8B,KAAL,GAAa;AACZC,MAAAA,eAAe,EAAE,CAAC,CADN;AAEZC,MAAAA,sBAAsB,EAAE,KAFZ;AAGZC,MAAAA,qBAAqB,EAAE,KAHX;AAIZC,MAAAA,QAAQ,EAAE,IAJE;AAKZ3B,MAAAA,IAAI,EAAE;AALM,KAAb;AAlBa;AAyBb;;;;wCAEmB;AACnB4B,MAAAA,MAAM,CAACC,gBAAP,CAAyB,UAAzB,EAAqC,KAAKZ,UAA1C;AACAW,MAAAA,MAAM,CAACC,gBAAP,CAAyB,SAAzB,EAAoC,KAAKV,cAAzC;AACA;;;2CAEsB;AACtBS,MAAAA,MAAM,CAACE,mBAAP,CAA4B,UAA5B,EAAwC,KAAKb,UAA7C;AACAW,MAAAA,MAAM,CAACE,mBAAP,CAA4B,SAA5B,EAAuC,KAAKX,cAA5C;AACA;;;gCAEYlB,Q,EAAW;AACvB,WAAKoB,SAAL,CAAeU,IAAf,CAAqB9B,QAArB;AACA;;;mCAEeA,Q,EAAW;AAC1B,WAAKoB,SAAL,GAAiBnC,MAAM,CAAE,KAAKmC,SAAP,EAAkB,UAAEW,EAAF;AAAA,eAAUA,EAAE,KAAK/B,QAAjB;AAAA,OAAlB,CAAvB;AACA;;;qCAEgB;AAChB;AACA,WAAKmB,0BAAL,CAAgCa,MAAhC;AAFgB,wBAIoC,KAAKV,KAJzC;AAAA,UAIRE,sBAJQ,eAIRA,sBAJQ;AAAA,UAIgBD,eAJhB,eAIgBA,eAJhB;;AAKhB,UAAK,CAAEC,sBAAF,IAA4BD,eAAe,KAAK,CAAC,CAAtD,EAA0D;AACzD;AACA;;AAED,WAAKU,QAAL,CAAe;AACdV,QAAAA,eAAe,EAAE,CAAC,CADJ;AAEdC,QAAAA,sBAAsB,EAAE,KAFV;AAGdC,QAAAA,qBAAqB,EAAE,KAHT;AAIdC,QAAAA,QAAQ,EAAE,IAJI;AAKd3B,QAAAA,IAAI,EAAE;AALQ,OAAf;AAQA,WAAKqB,SAAL,CAAec,OAAf,CAAwB,UAAElC,QAAF;AAAA,eAAgBA,QAAQ,CAACiC,QAAT,CAAmB;AAC1DT,UAAAA,sBAAsB,EAAE,KADkC;AAE1DC,UAAAA,qBAAqB,EAAE,KAFmC;AAG1DC,UAAAA,QAAQ,EAAE,IAHgD;AAI1D3B,UAAAA,IAAI,EAAE;AAJoD,SAAnB,CAAhB;AAAA,OAAxB;AAMA;;;+CAE2BoC,K,EAAOC,a,EAAgB;AAAA;;AAClD;AACA;AACA;AACA;AACA;AACA;AACA,UAAMC,MAAM,GAAGV,MAAM,CAACW,WAAP,IAAsBH,KAAK,YAAYR,MAAM,CAACW,WAA9C,GAA4DH,KAAK,CAACE,MAAlE,GAA2EF,KAA1F,CAPkD,CASlD;;AACA,UAAMI,gBAAgB,GAAGtD,MAAM,CAAE,KAAKmC,SAAP,EAAkB,UAAEpB,QAAF;AAAA,eAChDF,yBAAyB,CAAEsC,aAAF,EAAiBpC,QAAjB,CAAzB,IACAI,qBAAqB,CAAEJ,QAAQ,CAACK,OAAX,EAAoBgC,MAAM,CAACG,OAA3B,EAAoCH,MAAM,CAACI,OAA3C,CAF2B;AAAA,OAAlB,CAA/B,CAVkD,CAelD;;AACA,UAAMlB,eAAe,GAAGxC,IAAI,CAAEwD,gBAAF,EAAoB,UAAEG,IAAF;AAAA,eAC/C,CAAE1D,IAAI,CAAEuD,gBAAF,EAAoB,UAAEI,OAAF;AAAA,iBAAeA,OAAO,KAAKD,IAAZ,IAAoBA,IAAI,CAACrC,OAAL,CAAauC,aAAb,CAA2BC,QAA3B,CAAqCF,OAAO,CAACtC,OAA7C,CAAnC;AAAA,SAApB,CADyC;AAAA,OAApB,CAA5B;AAIA,UAAMyC,oBAAoB,GAAG,KAAK1B,SAAL,CAAe2B,OAAf,CAAwBxB,eAAxB,CAA7B;AAEA,UAAIG,QAAQ,GAAG,IAAf;;AAEA,UAAKH,eAAL,EAAuB;AACtB,YAAMf,IAAI,GAAGe,eAAe,CAAClB,OAAhB,CAAwBI,qBAAxB,EAAb;AAEAiB,QAAAA,QAAQ,GAAG;AACVpB,UAAAA,CAAC,EAAE+B,MAAM,CAACG,OAAP,GAAiBhC,IAAI,CAACI,IAAtB,GAA6BJ,IAAI,CAACK,KAAL,GAAawB,MAAM,CAACG,OAAjD,GAA2D,MAA3D,GAAoE,OAD7D;AAEVjC,UAAAA,CAAC,EAAE8B,MAAM,CAACI,OAAP,GAAiBjC,IAAI,CAACG,GAAtB,GAA4BH,IAAI,CAACE,MAAL,GAAc2B,MAAM,CAACI,OAAjD,GAA2D,KAA3D,GAAmE;AAF5D,SAAX;AAIA,OA/BiD,CAiClD;;;AACA,UAAIO,QAAQ,GAAG,EAAf;;AAEA,UAAK,CAAE,KAAK1B,KAAL,CAAWE,sBAAlB,EAA2C;AAC1CwB,QAAAA,QAAQ,GAAG,KAAK5B,SAAhB;AACA,OAFD,MAEO,IAAK0B,oBAAoB,KAAK,KAAKxB,KAAL,CAAWC,eAAzC,EAA2D;AACjE,YAAK,KAAKD,KAAL,CAAWC,eAAX,KAA+B,CAAC,CAArC,EAAyC;AACxCyB,UAAAA,QAAQ,CAAClB,IAAT,CAAe,KAAKV,SAAL,CAAgB,KAAKE,KAAL,CAAWC,eAA3B,CAAf;AACA;;AACD,YAAKA,eAAL,EAAuB;AACtByB,UAAAA,QAAQ,CAAClB,IAAT,CAAeP,eAAf;AACA;AACD,OAPM,MAOA,IACNA,eAAe,IACfuB,oBAAoB,KAAK,KAAKxB,KAAL,CAAWC,eADpC,IAEA,CAAEzC,OAAO,CAAE4C,QAAF,EAAY,KAAKJ,KAAL,CAAWI,QAAvB,CAHH,EAIL;AACDsB,QAAAA,QAAQ,CAAClB,IAAT,CAAeP,eAAf;AACA,OAnDiD,CAqDlD;;;AACAyB,MAAAA,QAAQ,CAACC,GAAT,CAAc,UAAEjD,QAAF,EAAgB;AAC7B,YAAMkD,KAAK,GAAG,MAAI,CAAC9B,SAAL,CAAe2B,OAAf,CAAwB/C,QAAxB,CAAd;;AACA,YAAMmD,sBAAsB,GAAGD,KAAK,KAAKJ,oBAAzC;AACA9C,QAAAA,QAAQ,CAACiC,QAAT,CAAmB;AAClBT,UAAAA,sBAAsB,EAAE1B,yBAAyB,CAAEsC,aAAF,EAAiBpC,QAAjB,CAD/B;AAElByB,UAAAA,qBAAqB,EAAE0B,sBAFL;AAGlBzB,UAAAA,QAAQ,EAAEyB,sBAAsB,GAAGzB,QAAH,GAAc,IAH5B;AAIlB3B,UAAAA,IAAI,EAAEoD,sBAAsB,GAAGf,aAAH,GAAmB;AAJ7B,SAAnB;AAMA,OATD;AAWA,UAAMgB,QAAQ,GAAG;AAChB5B,QAAAA,sBAAsB,EAAE,IADR;AAEhBD,QAAAA,eAAe,EAAEuB,oBAFD;AAGhBpB,QAAAA,QAAQ,EAARA;AAHgB,OAAjB;;AAKA,UAAK,CAAEpC,cAAc,CAAE8D,QAAF,EAAY,KAAK9B,KAAjB,CAArB,EAAgD;AAC/C,aAAKW,QAAL,CAAemB,QAAf;AACA;AACD;;;+BAEWjB,K,EAAQ;AACnB,WAAKhB,0BAAL,CAAiCgB,KAAjC,EAAwCxC,gBAAgB,CAAEwC,KAAF,CAAxD;AACAA,MAAAA,KAAK,CAACkB,cAAN;AACA;;;2BAEOlB,K,EAAQ;AACf;AACA;AACAA,MAAAA,KAAK,CAACvC,YAAN,IAAsBuC,KAAK,CAACvC,YAAN,CAAmB0D,KAAnB,CAAyBC,MAA/C,CAHe,CAGwC;;AAHxC,yBAKuB,KAAKjC,KAL5B;AAAA,UAKPI,QALO,gBAKPA,QALO;AAAA,UAKGH,eALH,gBAKGA,eALH;AAMf,UAAMa,aAAa,GAAGzC,gBAAgB,CAAEwC,KAAF,CAAtC;AACA,UAAMnC,QAAQ,GAAG,KAAKoB,SAAL,CAAgBG,eAAhB,CAAjB;AACA,WAAKL,cAAL;;AAEA,UAAKlB,QAAL,EAAgB;AACf,gBAASoC,aAAT;AACC,eAAK,MAAL;AACCpC,YAAAA,QAAQ,CAACC,WAAT,oBAA2BkC,KAAK,CAACvC,YAAN,CAAmB0D,KAA9C,GAAuD5B,QAAvD;AACA;;AACD,eAAK,MAAL;AACC1B,YAAAA,QAAQ,CAACE,UAAT,CAAqBiC,KAAK,CAACvC,YAAN,CAAmB4D,OAAnB,CAA4B,WAA5B,CAArB,EAAgE9B,QAAhE;AACA;;AACD,eAAK,SAAL;AACC1B,YAAAA,QAAQ,CAACG,MAAT,CAAiBgC,KAAjB,EAAwBT,QAAxB;AARF;AAUA;;AAEDS,MAAAA,KAAK,CAACsB,eAAN;AACAtB,MAAAA,KAAK,CAACkB,cAAN;AACA;;;6BAEQ;AACR,aACC;AAAK,QAAA,MAAM,EAAG,KAAKlD,MAAnB;AAA4B,QAAA,SAAS,EAAC;AAAtC,SACC,cAAC,QAAD;AAAU,QAAA,KAAK,EAAG,KAAKkB;AAAvB,SACG,KAAKqC,KAAL,CAAWC,QADd,CADD,CADD;AAOA;;;;EA1L6BvE,S;;AA6L/B,eAAe0B,gBAAf;AACA,SAASpB,QAAQ,IAAIkE,gBAArB","sourcesContent":["/**\n * External dependencies\n */\nimport { isEqual, find, some, filter, throttle, includes } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { Component, createContext } from '@wordpress/element';\nimport isShallowEqual from '@wordpress/is-shallow-equal';\n\nconst { Provider, Consumer } = createContext( {\n\taddDropZone: () => {},\n\tremoveDropZone: () => {},\n} );\n\nconst getDragEventType = ( { dataTransfer } ) => {\n\tif ( dataTransfer ) {\n\t\t// Use lodash `includes` here as in the Edge browser `types` is implemented\n\t\t// as a DomStringList, whereas in other browsers it's an array. `includes`\n\t\t// happily works with both types.\n\t\tif ( includes( dataTransfer.types, 'Files' ) ) {\n\t\t\treturn 'file';\n\t\t}\n\n\t\tif ( includes( dataTransfer.types, 'text/html' ) ) {\n\t\t\treturn 'html';\n\t\t}\n\t}\n\n\treturn 'default';\n};\n\nconst isTypeSupportedByDropZone = ( type, dropZone ) => {\n\treturn ( type === 'file' && dropZone.onFilesDrop ) ||\n\t\t( type === 'html' && dropZone.onHTMLDrop ) ||\n\t\t( type === 'default' && dropZone.onDrop );\n};\n\nconst isWithinElementBounds = ( element, x, y ) => {\n\tconst rect = element.getBoundingClientRect();\n\t/// make sure the rect is a valid rect\n\tif ( rect.bottom === rect.top || rect.left === rect.right ) {\n\t\treturn false;\n\t}\n\n\treturn x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom;\n};\n\nclass DropZoneProvider extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\t// Event listeners\n\t\tthis.onDragOver = this.onDragOver.bind( this );\n\t\tthis.onDrop = this.onDrop.bind( this );\n\t\t// Context methods so this component can receive data from consumers\n\t\tthis.addDropZone = this.addDropZone.bind( this );\n\t\tthis.removeDropZone = this.removeDropZone.bind( this );\n\t\t// Utility methods\n\t\tthis.resetDragState = this.resetDragState.bind( this );\n\t\tthis.toggleDraggingOverDocument = throttle( this.toggleDraggingOverDocument.bind( this ), 200 );\n\n\t\tthis.dropZones = [];\n\t\tthis.dropZoneCallbacks = {\n\t\t\taddDropZone: this.addDropZone,\n\t\t\tremoveDropZone: this.removeDropZone,\n\t\t};\n\t\tthis.state = {\n\t\t\thoveredDropZone: -1,\n\t\t\tisDraggingOverDocument: false,\n\t\t\tisDraggingOverElement: false,\n\t\t\tposition: null,\n\t\t\ttype: null,\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\t\twindow.addEventListener( 'dragover', this.onDragOver );\n\t\twindow.addEventListener( 'mouseup', this.resetDragState );\n\t}\n\n\tcomponentWillUnmount() {\n\t\twindow.removeEventListener( 'dragover', this.onDragOver );\n\t\twindow.removeEventListener( 'mouseup', this.resetDragState );\n\t}\n\n\taddDropZone( dropZone ) {\n\t\tthis.dropZones.push( dropZone );\n\t}\n\n\tremoveDropZone( dropZone ) {\n\t\tthis.dropZones = filter( this.dropZones, ( dz ) => dz !== dropZone );\n\t}\n\n\tresetDragState() {\n\t\t// Avoid throttled drag over handler calls\n\t\tthis.toggleDraggingOverDocument.cancel();\n\n\t\tconst { isDraggingOverDocument, hoveredDropZone } = this.state;\n\t\tif ( ! isDraggingOverDocument && hoveredDropZone === -1 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setState( {\n\t\t\thoveredDropZone: -1,\n\t\t\tisDraggingOverDocument: false,\n\t\t\tisDraggingOverElement: false,\n\t\t\tposition: null,\n\t\t\ttype: null,\n\t\t} );\n\n\t\tthis.dropZones.forEach( ( dropZone ) => dropZone.setState( {\n\t\t\tisDraggingOverDocument: false,\n\t\t\tisDraggingOverElement: false,\n\t\t\tposition: null,\n\t\t\ttype: null,\n\t\t} ) );\n\t}\n\n\ttoggleDraggingOverDocument( event, dragEventType ) {\n\t\t// In some contexts, it may be necessary to capture and redirect the\n\t\t// drag event (e.g. atop an `iframe`). To accommodate this, you can\n\t\t// create an instance of CustomEvent with the original event specified\n\t\t// as the `detail` property.\n\t\t//\n\t\t// See: https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events\n\t\tconst detail = window.CustomEvent && event instanceof window.CustomEvent ? event.detail : event;\n\n\t\t// Index of hovered dropzone.\n\t\tconst hoveredDropZones = filter( this.dropZones, ( dropZone ) =>\n\t\t\tisTypeSupportedByDropZone( dragEventType, dropZone ) &&\n\t\t\tisWithinElementBounds( dropZone.element, detail.clientX, detail.clientY )\n\t\t);\n\n\t\t// Find the leaf dropzone not containing another dropzone\n\t\tconst hoveredDropZone = find( hoveredDropZones, ( zone ) => (\n\t\t\t! some( hoveredDropZones, ( subZone ) => subZone !== zone && zone.element.parentElement.contains( subZone.element ) )\n\t\t) );\n\n\t\tconst hoveredDropZoneIndex = this.dropZones.indexOf( hoveredDropZone );\n\n\t\tlet position = null;\n\n\t\tif ( hoveredDropZone ) {\n\t\t\tconst rect = hoveredDropZone.element.getBoundingClientRect();\n\n\t\t\tposition = {\n\t\t\t\tx: detail.clientX - rect.left < rect.right - detail.clientX ? 'left' : 'right',\n\t\t\t\ty: detail.clientY - rect.top < rect.bottom - detail.clientY ? 'top' : 'bottom',\n\t\t\t};\n\t\t}\n\n\t\t// Optimisation: Only update the changed dropzones\n\t\tlet toUpdate = [];\n\n\t\tif ( ! this.state.isDraggingOverDocument ) {\n\t\t\ttoUpdate = this.dropZones;\n\t\t} else if ( hoveredDropZoneIndex !== this.state.hoveredDropZone ) {\n\t\t\tif ( this.state.hoveredDropZone !== -1 ) {\n\t\t\t\ttoUpdate.push( this.dropZones[ this.state.hoveredDropZone ] );\n\t\t\t}\n\t\t\tif ( hoveredDropZone ) {\n\t\t\t\ttoUpdate.push( hoveredDropZone );\n\t\t\t}\n\t\t} else if (\n\t\t\thoveredDropZone &&\n\t\t\thoveredDropZoneIndex === this.state.hoveredDropZone &&\n\t\t\t! isEqual( position, this.state.position )\n\t\t) {\n\t\t\ttoUpdate.push( hoveredDropZone );\n\t\t}\n\n\t\t// Notifying the dropzones\n\t\ttoUpdate.map( ( dropZone ) => {\n\t\t\tconst index = this.dropZones.indexOf( dropZone );\n\t\t\tconst isDraggingOverDropZone = index === hoveredDropZoneIndex;\n\t\t\tdropZone.setState( {\n\t\t\t\tisDraggingOverDocument: isTypeSupportedByDropZone( dragEventType, dropZone ),\n\t\t\t\tisDraggingOverElement: isDraggingOverDropZone,\n\t\t\t\tposition: isDraggingOverDropZone ? position : null,\n\t\t\t\ttype: isDraggingOverDropZone ? dragEventType : null,\n\t\t\t} );\n\t\t} );\n\n\t\tconst newState = {\n\t\t\tisDraggingOverDocument: true,\n\t\t\thoveredDropZone: hoveredDropZoneIndex,\n\t\t\tposition,\n\t\t};\n\t\tif ( ! isShallowEqual( newState, this.state ) ) {\n\t\t\tthis.setState( newState );\n\t\t}\n\t}\n\n\tonDragOver( event ) {\n\t\tthis.toggleDraggingOverDocument( event, getDragEventType( event ) );\n\t\tevent.preventDefault();\n\t}\n\n\tonDrop( event ) {\n\t\t// This seemingly useless line has been shown to resolve a Safari issue\n\t\t// where files dragged directly from the dock are not recognized\n\t\tevent.dataTransfer && event.dataTransfer.files.length; // eslint-disable-line no-unused-expressions\n\n\t\tconst { position, hoveredDropZone } = this.state;\n\t\tconst dragEventType = getDragEventType( event );\n\t\tconst dropZone = this.dropZones[ hoveredDropZone ];\n\t\tthis.resetDragState();\n\n\t\tif ( dropZone ) {\n\t\t\tswitch ( dragEventType ) {\n\t\t\t\tcase 'file':\n\t\t\t\t\tdropZone.onFilesDrop( [ ...event.dataTransfer.files ], position );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'html':\n\t\t\t\t\tdropZone.onHTMLDrop( event.dataTransfer.getData( 'text/html' ), position );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'default':\n\t\t\t\t\tdropZone.onDrop( event, position );\n\t\t\t}\n\t\t}\n\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div onDrop={ this.onDrop } className=\"components-drop-zone__provider\">\n\t\t\t\t<Provider value={ this.dropZoneCallbacks }>\n\t\t\t\t\t{ this.props.children }\n\t\t\t\t</Provider>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default DropZoneProvider;\nexport { Consumer as DropZoneConsumer };\n"]}